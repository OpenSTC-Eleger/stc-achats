<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>

		<record id="purchase_order_ask_tree" model="ir.ui.view">
			<field name="name">purchase.order.ask.tree</field>
			<field name="model">purchase.order.ask</field>
			<field name="type">tree</field>
			<field name="arch" type="xml">
				<tree string="Demandes de Devis">
					<field name="sequence" />
					<field name="name" />
					<field name="date_order" />
					<field name="state" />
				</tree>
			</field>
		</record>

		<record id="purchase_order_inherit_form" model="ir.ui.view">
			<field name="name">purchase.order.open.form</field>
			<field name="model">purchase.order</field>
			<field name="type">form</field>
			<field name="inherit_id" ref="purchase.purchase_order_form" />
			<field name="arch" type="xml">
				<xpath expr="//notebook/page[@string='Purchase Order']/group[@col='11']"
					position="after">
					<group col="6" colspan="4">
						<field name="validation" />
						<field name="engage_id" />
					</group>
				</xpath>
				<xpath
					expr="//notebook/page[@string='Purchase Order']/field[@name='partner_id']"
					position="before">
					<field name="po_ask_id" />
					<field name="po_ask_date" />
				</xpath>
				<field name="invoiced" position="after">
					<field name="user_id" readonly="1" />
					<field name="service_id" />
				</field>
				<field name="origin" position="after">
					<field name="account_analytic_id" domain="[('crossovered_budget_line','&lt;&gt;', False)]"
						groups="base.group_extended" />
				</field>
				<field name="order_line" position="attributes">
				    <attribute name="attrs">{'readonly':['|',('state','in',('approved','done')),('validation','!=','budget_to_check')]}</attribute>
				</field>
				<tree string="Purchase Order Lines" position="replace">
					<tree string="Purchase Order Lines" colors="red:(dispo==False and engage_line_id==False)">
						<field name="date_planned" />
						<field name="product_id" domain="[('purchase_ok','=',True)]"/>
						<field name="product_qty" />
						<!-- <field name="price_unit"/> -->
						<field name="amount_ttc" />
						<field name="budget_dispo_info" />
						<field name="account_analytic_id" string="Ligne Budgétaire" />
						<field name="dispo" />
						<field name="engage_line_id" />
					</tree>
				</tree>
				<field name="name" position="after">
					<field name="description" required="1" />
					<newline />
				</field>
				<button name="purchase_confirm" position="replace">
					<button name="open_engage" string="Créer/Gérer Engagement"
						type="object" icon="gtk-edit" />
				</button>
			</field>
		</record>

		<record id="purchase_order_line_inherit_form" model="ir.ui.view">
			<field name="name">purchase.order.line.open.form</field>
			<field name="model">purchase.order.line</field>
			<field name="type">form</field>
			<field name="inherit_id" ref="purchase.purchase_order_line_form" />
			<field name="arch" type="xml">
				<xpath
					expr="//notebook/page[@string='Order Line']/field[@name='account_analytic_id']"
					position="replace">
					<field name="account_analytic_id" string="Ligne Budgétaire"
						required="1" colspan="4" groups="analytic.group_analytic_accounting"
						domain="[('type','&lt;&gt;','view'), ('company_id', '=', company_id), ('crossovered_budget_line','&lt;&gt;',False)]"
						on_change="onchange_account_analytic_id(account_analytic_id)" />
					<field name="budget_dispo_info" />
					<field name="budget_dispo" invisible="1" />
					<field name="tx_erosion_info" />
					<field name="tx_erosion" invisible="1" />
					<field name="merge_line_ids"
						on_change="onchange_merge_line_ids(merge_line_ids, product_qty)">
						<tree editable="top">
							<field name="product_qty" />
							<field name="service_id" required="1"
								domain="[('accountant_service','in',('cost','production'))]" />
							<field name="site_id" domain="[('service','=',service_id)]" />
						</tree>
					</field>
					<field name="in_stock_info" />
					<field name="in_stock" invisible="1" />
				</xpath>
				<field name="product_id" position="replace">
					<field name="product_id" domain="[('purchase_ok','=',True)]"
						required="True" colspan="4"
						on_change="onchange_product_id(parent.pricelist_id,product_id,product_qty,product_uom,parent.partner_id, parent.date_order,parent.fiscal_position,date_planned,name,price_unit,notes,context,parent.account_analytic_id)" />
				</field>
			</field>
		</record>


		<record id="purchase_order_ask_form" model="ir.ui.view">
			<field name="name">purchase.order.ask.form</field>
			<field name="model">purchase.order.ask</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Demandes de Devis">
					<group col="6" colspan="4">
						<field name="sequence" />
						<field name="name" required="1" />
						<field name="date_order" />
					</group>
					<field name="user_id" />
					<field name="service_id" />
					<newline />
					<field name="suppliers_id" nolabel="1" colspan="4"
						attrs="{'readonly':[('state','=','done')]}">
						<tree string="Fournisseurs potentiels" editable="top"
							colors="red:notif_state=='error_mail';orange:notif_state=='nothing';green:notif_state=='mail'">
							<field name="partner_id" attrs="{'readonly':[('state','&lt;&gt;', 'draft')]}"
								domain="[('supplier','=',True)]" />
							<field name="partner_address_id" domain="[('partner_id','=',partner_id)]"
								attrs="{'readonly':[('state','&lt;&gt;', 'draft')]}" />
							<field name="selected"
								attrs="{'readonly':[('state','&lt;&gt;', 'waiting_selection')]}" />
							<field name="state" />
							<field name="notif_state"
								attrs="{'readonly':[('state','&lt;&gt;', 'waiting_selection')]}" />
						</tree>
					</field>
					<newline />
					<field name="order_lines" nolabel="1" colspan="4"
						attrs="{'readonly':[('state','=','done')]}">
						<tree string="Produits de la Demande" editable="top">
							<field name="product_id" domain="[('purchase_ok','=',True)]"
								on_change="onchange_product_id(product_id)" attrs="{'readonly':[('state','&lt;&gt;', 'draft')]}" />
							<field name="description" required="1"
								attrs="{'readonly':[('state','&lt;&gt;', 'draft')]}" />
							<field name="qte" attrs="{'readonly':[('state','&lt;&gt;', 'draft')]}" />
							<field name="price_unit"
								attrs="{'readonly':[('state','&lt;&gt;', 'waiting_pu')],'required':[('state','=','waiting_pu')]}" />
							<field name="date_order" attrs="{'readonly':[('state','&lt;&gt;', 'draft')]}" />
							<field name="infos" />
							<field name="state" />
						</tree>
					</field>
					<newline />
					<field name="state" />
					<field name="purchase_order_id" attrs="{'invisible':[('state','&lt;&gt;', 'done')]}" />
					<button name="cancel" string="Revenir au début" type="object"
						states="waiting_supplier" />
					<button name="validate_supplier" string="Valider Fourniseur"
						type="object" states="waiting_supplier" />
					<button name="send_ask" string="Envoyer demande (mails)"
						type="object" states="draft" />
					<button name="to_draft_po" string="Créer un Bon de Commande"
						type="object" states="waiting_purchase_order" />
					<button name="do_terminate" string="Clore Devis" type="object"
						states="waiting_purchase_order" />
				</form>
			</field>
		</record>

		<record id="open_achat_account_analytic_account_inherit_form"
			model="ir.ui.view">
			<field name="name">account.analytic.account.open.form</field>
			<field name="model">account.analytic.account</field>
			<field name="type">form</field>
			<field name="inherit_id" ref="account.view_account_analytic_account_form" />
			<field name="arch" type="xml">
				<page string="Account Data" position="inside">
					<field name="service_id" />
				</page>
			</field>
		</record>

		<record id="open_engage_tree_view" model="ir.ui.view">
			<field name="name">open.engagement.tree</field>
			<field name="model">open.engagement</field>
			<field name="type">tree</field>
			<field name="arch" type="xml">
				<tree string="Bon d'Engagements">
					<field name="name" />
					<field name="description" />
					<field name="state" />
				</tree>
			</field>
		</record>

		<record id="open_engage_form_view" model="ir.ui.view">
			<field name="name">open.engagement.form</field>
			<field name="model">open.engagement</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Bon d'Engagement">
					<group col="6" colspan="4">
						<group col="2" colspan="2" string="Infos Générales"
							groups="openstc.openstc_dst,openstc.openstc_manager,openstc.openstc_qualifier">
							<field name="name" />
							<field name="description" />
							<field name="user_id" />
							<field name="service_id" />
							<field name="purchase_order_id" />
							<field name="account_invoice_id" invisible="1" />
							<field name="date_engage_done" />
						</group>
						<group col="2" colspan="4" string="Numéros d'Engagements"
							attrs="{'invisible':[('state','in',('draft','to_validate','check_except'))]}">
							<field name="engage_lines" nolabel="1" colspan="2">
								<tree>
									<field name="name" />
									<field name="amount" />
									<field name="account_analytic_id" />
								</tree>
							</field>
							<field name="date_engage_validated" colspan="2" />
						</group>
					</group>
					<field name="invoice_ok" invisible="1" />
					<group col="2" colspan="1" string="Signatures du DST et d'un Elu"
						groups="openstc_achat_stock.openstc_elu,openstc.openstc_dst"
						attrs="{'invisible':[('state','not in',('draft','to_validate'))]}">
						<field name="check_dst" colspan="2" />
						<field name="procuration_dst" colspan="2" invisible="1" />
						<button name="%(open_engage_check_elu_wizard)d" icon="gtk-apply"
							string="Valider l'Engagement par l'Elu" type="action"
							attrs="{'invisible':[('state','&lt;&gt;','to_validate')]}"
							groups="openstc_achat_stock.openstc_elu" />
						<group colspan="1" col="2">
						    <field name="attach_datas_fname_sumup" invisible="1"/>
						    <field name="attach_datas_sumup" filename="attach_datas_fname_sumup"/>
						</group>
						<button name="signal_except_check" string="Refuser l'Engagement par l'Elu"
							icon="gtk-cancel" type="workflow"
							attrs="{'invisible':[('state','&lt;&gt;','to_validate')]}"
							groups="openstc_achat_stock.openstc_elu" />
						<button name="open_purchase" type="object"
							groups="openstc.openstc_dst,openstc.openstc_manager,openstc.openstc_qualifier" string="Voir la Commande"
							icon="gtk-edit" />
						<button name="%(open_engage_check_elu_wizard)d" string="Valider Par Procuration"
							type="action"
							attrs="{'invisible':['|',('state','&lt;&gt;','to_validate'),('procuration_dst','=',False)]}"
							groups="openstc.openstc_dst" colspan="2" />
						<button name="signal_except_check" string="Refuser Par Procuration"
							type="workflow"
							attrs="{'invisible':['|',('state','&lt;&gt;','to_validate'),('procuration_dst','=',False)]}"
							groups="openstc.openstc_dst" colspan="2" />
					</group>
					<group col="2" string="Réception de produits" colspan="1"
						attrs="{'invisible':[('state','in',('draft','to_validate'))]}">
						
						<button name="open_purchase" type="object"
							groups="openstc_achat_stock.openstc_elu" string="Voir la Commande"
							icon="gtk-edit" />
						<field name="reception_ok" />
						<button name="open_stock_moves" type="object"
							groups="openstc.openstc_dst,openstc.openstc_manager,openstc.openstc_qualifier"
							string="Voir Réception de Produits associée" states="waiting_reception"
							icon="gtk-print-preview" />
						<button name="write_ciril_engage" 
						    type="object" 
						    groups="openstc.openstc_dst,openstc.openstc_manager,openstc.openstc_qualifier"
							string="Create Engage(s) export file" 
							icon="gtk-execute"
						    states="waiting_reception,engage_to_terminate,done"/>
					</group>
					<group colspan="2" col="2">
						<field name="elu_id" />
						<field name="justif_check" colspan="2"
							groups="openstc_achat_stock.openstc_elu" />
						<field name="justif_check_infos" readonly="1" colspan="2"
							groups="openstc.openstc_manager,openstc.openstc_dst" />
					</group>
					<newline />
					<field name="attach_ids" nolabel="1" colspan="4"
						groups="openstc.openstc_dst,openstc.openstc_manager,openstc.openstc_qualifier">
						<tree string="Documents joints"
							colors="blue:state=='to_check';red:state=='refused';orange:state=='except_send_mail';green:state=='validated'">
							<field name="datas_fname" />
							<field name="create_uid" />
							<field name="create_date" />
							<field name="action_date" />
							<field name="state" />
							<field name="engage_done" />
							<field name="attach_made_done" />
							<button name="send_invoice_to_pay" type="object" icon="gtk-go-forward"
								help="Valide et Envoie la Facture au service compta pour paiement"
								states="to_check,except_send_mail" />
							<button name="action_refuse_invoice_to_pay" type="object"
								icon="gtk-cancel"
								help="Refuser la facture pour paiement, vous allez saisir un bref justificatif"
								states="to_check,except_send_mail" />
							<button name="engage_complete" type="object" icon="gtk-ok"
								help="Indiquer que la commande est entiérement soldée, cela clos l'engagement"
								attrs="{'invisible':['|',('engage_done','=',True),('state','=',('not_invoice'))]}"
								confirm="Attention, vous allez clore l'engagement. Ce qui signifie que tous les produits ont été reçus et que l'ensemble de la commande a été payée par la compta. Si ce n'est pas le cas, veuillez cliquez sur Annuler." />
							<button name="dummy" icon="gtk-help"
								help="Ceci indique que c'est cette facture qui A permis de clore l'engagement"
								attrs="{'invisible':['|',('attach_made_done','=',False),('state','=','not_invoice')]}" />
						</tree>
					</field>
					<field name="justificatif_refus"
						attrs="{'required':[('state','=','except_invoice')],'invisible':[('state','&lt;&gt;','except_invoice')]}" />
					<group col="6" colspan="1">
						<!-- <button name="real_invoice_attached" type="object" string="Facture 
							Fournisseur Jointe" states = "waiting_invoice"/> -->
					</group>
					<field name="state" widget="statusbar"
						statusbar_visible="draft,to_validate,waiting_reception,engage_to_terminate,done" />
				</form>
			</field>
		</record>

		<record model="ir.ui.view" id="view_openstc_open_engage_search_view">
			<field name="name">openstc.engagement.search</field>
			<field name="model">open.engagement</field>
			<field name="type">search</field>
			<field name="arch" type="xml">
				<search string="Engagements">
					<filter name="to_validate" string="A Signer"
						domain="[('state','in',('draft','to_validate'))]" help="Engagements Brouillons ou en attente signature DST + Elu" />
					<filter name="in_progress" string="En Cours"
						domain="[('state','in',('waiting_reception','waiting_invoice','waiting_invoice_validated'))]"
						help="Engagements en attente de couments Comptables" />
					<filter name="to_pay" string="Reste A Payer"
						domain="[('state','=','engage_to_terminate')]" help="Engagements dont la facture est a payer" />
					<filter name="done" string="Clos" domain="[('state','=','done')]"
						help="Engagement Clos (facture payée et et réception produits / prestation complet et validé)" />
					<filter name="except" string="Litigieux"
						domain="[('state','=','except_invoice')]" help="Engagements en Refus de Paiement" />
					<field name="name" string="Bon d'Engagement" filter_domain="[('name','ilike',self)]" />
					<field name="service_id" string="Service concerné" domain="[('open_engagement_ids','&lt;&gt;',False)]"
						filter_domain="[('service_id','=',self)]" widget="selection" />
					<field name="supplier_id" string="Fournisseur" domain="[('supplier','=',True)]"
						filter_domain="[('supplier_id','=',self)]" widget="selection" />
				</search>
			</field>
		</record>

		<record id="open_achat_stock_budget_tree_view" model="ir.ui.view">
			<field name="name">open.achat.stock.crossovered.budget.tree</field>
			<field name="model">crossovered.budget</field>
			<field name="type">tree</field>
			<field name="inherit_id" ref="account_budget.crossovered_budget_view_tree" />
			<field name="arch" type="xml">
				<field name="date_to" position="after">
					<field name="planned_amount" sum="Montant Plannifié" />
					<field name="openstc_practical_amount" sum="Montant Consommé" />
				</field>
			</field>
		</record>

		<record id="open_achat_stock_budget_form_view" model="ir.ui.view">
			<field name="name">open.achat.stock.crossovered.budget.form</field>
			<field name="model">crossovered.budget</field>
			<field name="type">form</field>
			<field name="inherit_id" ref="account_budget.crossovered_budget_view_form" />
			<field name="arch" type="xml">
				<xpath expr="//form/field[@name='crossovered_budget_line']/tree"
					position="replace">
					<tree string="Budget Lines">
					    <field name="openstc_general_account"/>
					    <field name="openstc_code_antenne"/>
						<field name="analytic_account_id" groups="analytic.group_analytic_accounting" />
						<field name="planned_amount" sum="Montant Planifié" />
						<field name="openstc_practical_amount" sum="Montant consommé" />
						<field name="openstc_erosion" />
					</tree>
				</xpath>
				<xpath expr="//form/field[@name='crossovered_budget_line']/form/field[@name='general_budget_id']"
					position="attributes">
					<attribute name="invisible">1</attribute>
				</xpath>
				<xpath expr="//form/field[@name='crossovered_budget_line']/form/field[@name='general_budget_id']"
					position="after">
					<field name="openstc_general_account" required="1" on_change="onchange_openstc_account_general(openstc_account_general)"/>
					<field name="openstc_code_antenne" required="1"/>
				</xpath>
				<xpath expr="//form/field[@name='crossovered_budget_line']/form/field[@name='analytic_account_id']"
				    position="attributes">
					<attribute name="domain">[('name','not like','Projects'),'|',('parent_id','=',False),('parent_id.name','not like','Projects')]</attribute>
				</xpath>
				<field name="code" position="replace"/>
				<field name="name" position="replace">
				    <group colspan="4" col="6">
				        <field name="name"/>
				        <field name="code"/>
				        <field name="code_budget_ciril"/>
				    </group>
				</field>
			</field>
		</record>

		<record model="ir.ui.view" id="openstc_achat_crossovered_budget_line_form_inherit">
            <field name="name">openstc.achat.crossovered.budget.line.form.inherit</field>
            <field name="model">crossovered.budget.lines</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="account_budget.view_crossovered_budget_line_form"/>
            <field name="arch" type="xml">
                    <field name="general_budget_id" position="attributes">
                    	<attribute name="invisible">1</attribute>
                    </field>
                    <field name="general_budget_id" position="after">
                        <field name="openstc_general_account" required="1" on_change="onchange_openstc_account_general(openstc_account_general)"/>
                    </field>
                    <field name="analytic_account_id" position="attributes">
                        <attribute name="domain">['|',('parent_id','=',False),('parent_id.name','not like','Projects')]</attribute>
                    </field>
            </field>
        </record>
		

		<record id="openstc_ask_prod_form" model="ir.ui.view">
			<field name="name">openstc.ask.prod.form</field>
			<field name="model">openstc.ask.prod</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Demande de Fournitures">
					<group col="4" colspan="4" string="Informations Générales">
						<field name="sequence"
							attrs="{'readonly':[('state','not in',('draft','waiting_validation'))]}" />
						<field name="name"
							attrs="{'readonly':[('state','not in',('draft','waiting_validation'))]}" />
						<field name="user_id"
							attrs="{'readonly':[('state','not in',('draft','waiting_validation'))]}" />
						<field name="date_order"
							attrs="{'readonly':[('state','not in',('draft','waiting_validation'))]}" />
					</group>
					<group col="4" colspan="4"
						string="Choisissez le site OU le service demandeur">
						<field name="service_id" attrs="{'readonly':[('state','!=','draft')]}" />
						<field name="site_id" attrs="{'readonly':[('state','!=','draft')]}" />
					</group>
					<field name="merge_line_ask_id" nolabel="1" colspan="4"
						attrs="{'readonly':[('state','not in',('draft','waiting_validation'))]}">
						<tree string="Votre Besoin" editable="top">
							<field name="product_id" required="1"
								domain="[('purchase_ok','=',True)]" context="{'force_product_uom':True}" />
							<field name="product_qty" />
							<field name="dispo" />
							<field name="service_id" />
							<field name="site_id" />
						</tree>
					</field>
					<field name="state" />
					<group col="2" colspan="1">
						<button name="confirm" string="Confirmer Votre Demande"
							states="draft" />
						<button name="validate" string="Valider Pour Demande en Stock"
							states="waiting_validation" />
						<button name="in_except" string="Annuler Demande"
							groups="openstc.openstc_manager,openstc.openstc_dst,openstc.openstc_elu"
							states='waiting_validation,in_progress' />
					</group>
				</form>
			</field>
		</record>

		<record id="openstc_merge_line_ask_tree_view" model="ir.ui.view">
			<field name="name">openstc.merge.line.ask.tree</field>
			<field name="model">openstc.merge.line.ask</field>
			<field name="type">tree</field>
			<field name="arch" type="xml">
				<tree string="Besoins en Fournitures Exprimés">
					<field name="product_id" domain="[('purchase_ok','=',True)]"/>
					<field name="service_id" />
					<field name="site_id" />
					<field name="product_qty" />
					<field name="qty_delivered" />
					<field name="qty_remaining" />
					<field name="qty_available" />
					<field name="merge_ask_donable" />
					<field name="merge_ask_done" />
					<button name="to_respond" type="object"
						help="Répondre A ce Besoin Précisément (la qté fournie est limitée au stock disponible)"
						icon="gtk-go-forward" attrs="{'invisible':[('qty_available','=',0)]}" />
					<button name="to_do_purchase" type="object"
						help="Crée une commande spécifique A ce Besoin" icon="gtk-edit"
						attrs="{'invisible':[('merge_ask_donable','=',True)]}" />
				</tree>
			</field>
		</record>

		<record model="ir.ui.view" id="view_openstc_merge_line_ask_search_view">
			<field name="name">openstc.merge.line.ask.search</field>
			<field name="model">openstc.merge.line.ask</field>
			<field name="type">search</field>
			<field name="arch" type="xml">
				<search string="Besoins">
					<filter name="ask_ok" string="Besoins Satisfaisables"
						domain="[('merge_ask_donable','=',True)]" help="Besoins où le stock est dispo" />
					<filter name="to_purchase" string="Besoins nécessitant une Réappro"
						domain="[('merge_ask_donable','=',False)]" help="Besoins nécessitant de réapprovisionner le stock" />
				</search>
			</field>
		</record>

		<record id="openstc_achat_stock_res_users_form" model="ir.ui.view">
			<field name="name">openstc.achat.stockres.users.inherit</field>
			<field name="model">res.users</field>
			<field name="type">form</field>
			<field name="inherit_id" ref="base.view_users_form" />
			<field name="arch" type="xml">
				<xpath expr="//form/group[@col='6']/field[@name='active']"
					position="before">
					<group col="4" colspan="4">
						<field name="max_po_amount" />
						<field name="max_total_amount" />
					</group>
				</xpath>
			</field>
		</record>

		<record id="openstc_merge_ask_to_respond_form" model="ir.ui.view">
			<field name="name">openstc.merge.line.ask.respond.wizard.form</field>
			<field name="model">openstc.merge.line.ask.respond.wizard</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Répondre Aux Besoins">
					<label string="Voulez-vous vraiment répondre A ces Besoins ?"
						colspan="4" />
					<field name="merge_ask_ids" colspan="4" nolabel="1" />
					<newline />
					<button special="cancel" string="Annuler" icon="gtk-cancel" />
					<button name="to_respond" type="object" string="Répondre aux Besoins"
						icon="gtk-go-forward" />
				</form>
			</field>
		</record>

		<record id="openstc_merge_ask_to_po_form" model="ir.ui.view">
			<field name="name">openstc.merge.line.ask.po.wizard.form</field>
			<field name="model">openstc.merge.line.ask.po.wizard</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Réapprovisionner pour répondre A ces Besoins">
					<label string="Voulez-vous vraiment lancer une Réappro pour ces Besoins ?"
						colspan="4" />
					<field name="merge_ask_ids" colspan="4" nolabel="1" />
					<newline />
					<group col="6" colspan="4">
						<label string="Retour en Arriere." colspan="2" />
						<label
							string="Vous pouvez faire un Achat sans marché, c'est A dire que vous devrez passer par une demande de prix."
							colspan="2" />
						<label
							string="Vous pouvez faire un Achat avec Marché, vous serez directement dirigé vers un Bon de Commande associé au Marché correspondant aux fournitures désignées."
							colspan="2" />
					</group>
					<group col="6" colspan="4">
						<button special="cancel" string="Annuler" icon="gtk-cancel" />
						<button name="to_po_ask" type="object" string="Faire un Achat sans marché"
							icon="gtk-go-forward" />
						<button name="to_po" type="object" string="Faire un Achat avec marché"
							icon="gtk-go-forward" />
					</group>
				</form>
			</field>
		</record>

		<record id="openstc_open_engage_refuse_inv_wizard" model="ir.ui.view">
			<field name="name">openstc.open.engage.refuse.inv.wizard.form</field>
			<field name="model">openstc.open.engage.refuse.inv.wizard</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form>
					<label
						string="Veuillez Saisir la raison de votre refus pour le paiement de la facture sélectionnée"
						colspan="4" />
					<field name="justif_refuse" colspan="4" nolabel="1" />
					<button special="cancel" string="Anuler" icon="gtk-cancel" />
					<button name="to_refuse" type="object" string="Valider"
						icon="gtk-go-forward" />
				</form>
			</field>
		</record>


		<record id="openstc_open_engage_check_elu_wizard" model="ir.ui.view">
			<field name="name">open.engagement.check.elu.wizard.form</field>
			<field name="model">open.engagement.check.elu.wizard</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Donner une note explicative pour votre Autorisation">
					<label
						string="Veuillez Saisir la raison de votre autorisation du Bon d'Engagement"
						colspan="4" />
					<field name="justif_check" colspan="4" nolabel="1" />
					<button special="cancel" string="Anuler" icon="gtk-cancel" />
					<button name="check_elu" type="object" string="Valider"
						icon="gtk-go-forward" />
				</form>
			</field>
		</record>



		<record id="openstc_ir_attachment_inherit_form" model="ir.ui.view">
			<field name="name">ir.attachment.inherit.form</field>
			<field name="model">ir.attachment</field>
			<field name="type">form</field>
			<field name="inherit_id" ref="base.view_attachment_form" />
			<field name="arch" type="xml">
				<group col="2" groups="base.group_extended" position="after">
					<group col="1" colspan="4"
						attrs="{'invisible':[('state','&lt;&gt;','refused')]}">
						<field name="state" invisible="1" />
						<separator string="Justificatif de l'acheteur de son Refus pour Paiement" />
						<field name="justif_refuse" nolabel="1" />
					</group>
				</group>
			</field>
		</record>

		<record id="openstc_res_company_inherit_form" model="ir.ui.view">
			<field name="name">res.company.inherit.form</field>
			<field name="model">res.company</field>
			<field name="type">form</field>
			<field name="inherit_id" ref="base.view_company_form" />
			<field name="arch" type="xml">
				<page string="Configuration" position="inside">
					<separator string="Préférenes Comptabilité Collectivité"
						colspan="4" />
					<field name="base_seuil_po" />
				</page>
			</field>
		</record>

		<record id="openstc_service_achats_inherit" model="ir.ui.view">
			<field name="name">openstc.service.achats.inherit</field>
			<field name="model">openstc.service</field>
			<field name="type">form</field>
			<field name="inherit_id" ref="openstc.view_openstc_service_form" />
			<field name="arch" type="xml">
				<field name="technical" position="after">
					<field name="accountant_service" />
				</field>
				<field name="name" position="after">
				    <field name="code_serv_ciril" invisible="1"/>
				</field>
			</field>
		</record>

		<record id="openstc_res_partner_achats_inherit" model="ir.ui.view">
			<field name="name">openstc.res.partner.achats.inherit</field>
			<field name="model">res.partner</field>
			<field name="type">form</field>
			<field name="inherit_id" ref="base.view_partner_form" />
			<field name="arch" type="xml">
				<page string="General" position="after">
					<page string="Activities">
						<field name="activity_ids" nolabel="1">
							<tree string="Activities">
								<field name="complete_name" />
							</tree>
						</field>
					</page>
				</page>
				<field name="name" position="after">
					<field name="code_tiers_ciril" invisible="1"/>
				</field>
			</field>
		</record>
		
		<record id="view_openstc_achats_partner_filter_inherit" model="ir.ui.view">
		    <field name="name">res.partner.search.achats.inherit</field>
		    <field name="model">res.partner</field>
		    <field name="type">search</field>
		    <field name="inherit_id" ref="openstc.view_openstc_partner_filter"/>
		    <field name="arch" type="xml">
	            <field name="technical_site_id" position="after">
	            	<newline/>
	            	<field name="activity_ids" filter_domain="[('activity_ids','ilike',self)]"
	            	    widget="selection"/>
	            	<newline/>
	            </field>
		    </field>
		</record>
		
		<record id="view_openstc_po_ask_search" model="ir.ui.view">
		    <field name="name">openstc.purchase.order.ask.search</field>
		    <field name="model">purchase.order.ask</field>
		    <field name="type">search</field>
		    <field name="arch" type="xml">
	            <search>
		            <filter name="to_confirm" string="Ask to confirm"
							domain="[('state','in',('draft','waiting_supplier'))]" help="Asks waiting for mail sending or waiting for supplier choose" />
		            <filter name="confirm" string="Confirmed Ask"
							domain="[('state','=','waiting_purchase_order')]" help="Asks being able to create purchase orders" />
		            <filter name="done" string="Done Ask"
							domain="[('state','=','done')]" help="Asks no longer available"/>
		            	            
		            <field name="service_id" domain="[('purchase_order_ask_ids', '&lt;&gt;', False)]"
		                filter_domain="[('service_id','=',self)]" string="Service" widget="selection"/>
		    	</search>
		    </field>
		</record>
	</data>
</openerp>